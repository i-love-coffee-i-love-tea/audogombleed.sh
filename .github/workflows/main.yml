name: "Automated Bash Tests"
on: [push, pull_request]
jobs:
  build:
    name: build
    runs-on: ubuntu-latest
    steps:
      - name: Check out repository code
        uses: actions/checkout@v4
        with:
          submodules: 'true'
      - run: echo "The ${{ github.repository }} repository has been cloned to the runner."
      - run: echo "The workflow is now ready to test your code on the runner."
      - name: List files in the repository
        run: |
          ls ${{ github.workspace }}/test/
          ls ${{ github.workspace }}/test/test_helper
      - run: echo "This job's status is ${{ job.status }}."

      - name: Test
        run: test/bats/bin/bats --report-formatter junit --output /tmp test/test.bats


      - name: Test Report
        uses: phoenix-actions/test-reporting@v8
        id: test-report               # Set ID reference for step
        if: success() || failure()    # run this step even if previous step failed
        with:
          name: BATS Tests            # Name of the check run which will be created
          path: /tmp/report.xml    # Path to test results
          reporter: java-junit        # Format of test results

      - name: Read output variables
        run: |
          echo "url is ${{ steps.test-report.outputs.runHtmlUrl }}"


      
